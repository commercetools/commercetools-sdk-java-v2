<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (16) -->
<title>Middlewares (commercetools-java-sdks 13.2.0 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: com.commercetools.docs.meta, class: Middlewares">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar.top">
<div class="skip-nav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar.top.firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li>Method</li>
</ul>
</div>
<div class="nav-list-search"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip.navbar.top">
<!--   -->
</span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">com.commercetools.docs.meta</a></div>
<h1 title="Class Middlewares" class="title">Class Middlewares</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">com.commercetools.docs.meta.Middlewares</div>
</div>
<section class="description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name"><a href="../../../../src-html/com/commercetools/docs/meta/Middlewares.html#line.73">Middlewares</a></span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block"><b>Table of content</b><ul><li>Middlewares</li><ul><li>ErrorMiddleware</li><li>OAuthMiddleware</li><li>RetryMiddleware</li><li>ConcurrentModificationMiddleware</li><li>UserAgentMiddleware</li><li>AcceptGZipMiddleware</li><li>InternalLoggerMiddleware</li></ul></ul>
    <h2>Middlewares</h2>

    <p></p>

    <h3>ErrorMiddleware</h3>

    <p>The <a href="../../../../io/vrap/rmf/base/client/http/ErrorMiddleware.html" title="interface in io.vrap.rmf.base.client.http"><code>ErrorMiddleware</code></a> is used to react to erroneous HTTP responses. It will always
    be placed as first middleware in the <a href="../../../../io/vrap/rmf/base/client/http/HandlerStack.html" title="class in io.vrap.rmf.base.client.http"><code>HandlerStack</code></a>. The default implementation
    converts responses with a status code 400 or higher to exceptions. For creating the exceptions it uses a
    <a href="../../../../io/vrap/rmf/base/client/error/HttpExceptionFactory.html" title="interface in io.vrap.rmf.base.client.error"><code>HttpExceptionFactory</code></a>.</p>

    <div id="io-vrap-rmf-base-client-http-ErrorMiddlewareImpl-invoke-io-vrap-rmf-base-client-ApiHttpRequest--java-util-function-Function-%s" class=code-example><pre><code class='java'>if (exceptionMode == ExceptionMode.COMPLETION_EXCEPTION) {
    return next.apply(request).thenApply(response -&gt; {
        if (response.getStatusCode() &gt;= 400) {
            throw exceptionFactory.create(request, response);
        }
        return response;
    });
}

CompletableFuture&lt;ApiHttpResponse&lt;byte[]&gt;&gt; result = new CompletableFuture&lt;&gt;();
next.apply(request).whenComplete((response, throwable) -&gt; {
    if (throwable != null) {
        Throwable unwrap = throwable instanceof CompletionException ? throwable.getCause() : throwable;
        result.completeExceptionally(unwrap);
    }
    if (response != null) {
        if (response.getStatusCode() &gt;= 400) {
            try {
                result.completeExceptionally(exceptionFactory.create(request, response));
            }
            catch (Throwable e) {
                result.completeExceptionally(e);
            }
        }
    }
    result.complete(response);
});

return result;
</code><p>See the <a href="https://github.com/commercetools/commercetools-sdk-java-v2/blob/master/rmf/rmf-java-base/src/main/java/io/vrap/rmf/base/client/http/ErrorMiddlewareImpl.java" target="_blank">test code</a>.</pre></div>

    <h3>OAuthMiddleware</h3>

    <p>An <a href="../../../../io/vrap/rmf/base/client/http/OAuthMiddleware.html" title="interface in io.vrap.rmf.base.client.http"><code>OAuthMiddleware</code></a> is used to authenticate a request against the commercetools Composable Commerce
    APIs. The default implementation adds an auth header to the request instance. In case of an expired token it will try to
    reauthenticate automatically. To retrieve an <a href="../../../../io/vrap/rmf/base/client/AuthenticationToken.html" title="class in io.vrap.rmf.base.client"><code>AuthenticationToken</code></a> the
    <a href="../../../../io/vrap/rmf/base/client/http/OAuthHandler.html" title="class in io.vrap.rmf.base.client.http"><code>OAuthHandler</code></a> is called.</p>

    <div id="io-vrap-rmf-base-client-http-OAuthMiddlewareImpl-invoke-io-vrap-rmf-base-client-ApiHttpRequest--java-util-function-Function-%s" class=code-example><pre><code class='java'>return failsafeExecutor.getStageAsync(() -&gt; {
    if (request.getHeaders().getFirst(ApiHttpHeaders.AUTHORIZATION) != null) {
        return next.apply(request);
    }
    AuthenticationToken token = authHandler.getToken();
    return next.apply(request.addHeader(ApiHttpHeaders.AUTHORIZATION, OAuthHandler.authHeader(token)));
});
</code><p>See the <a href="https://github.com/commercetools/commercetools-sdk-java-v2/blob/master/rmf/rmf-java-base/src/main/java/io/vrap/rmf/base/client/http/OAuthMiddlewareImpl.java" target="_blank">test code</a>.</pre></div>

    <h3>RetryMiddleware</h3>

    <p>The <a href="../../../../io/vrap/rmf/base/client/http/RetryRequestMiddleware.html" title="interface in io.vrap.rmf.base.client.http"><code>RetryRequestMiddleware</code></a> is used to retry a failed request returns with the configured
    status codes e.g. <code>503</code>. For retrying an exponential backoff strategy is used which will increase the wait
    time before each try to avoid overwhelming the API. A jitter is also added to avoid reduce the possibility that parallel
    requests will be retried at the same time.</p>

    <p>The retry implementation uses the library <a href="https://failsafe.dev/">failsafe</a></p>

    <h3>ConcurrentModificationMiddleware</h3>

    <p>The <a href="../../api/client/ConcurrentModificationMiddleware.html" title="interface in com.commercetools.api.client"><code>ConcurrentModificationMiddleware</code></a> is used to retry a failed request which returns the
    status codes <code>409</code> (concurrent modification). For retrying an exponential backoff strategy is used which will increase
    the wait time before each try to avoid overwhelming the API. A jitter is also added to avoid reduce the possibility that parallel
    requests will be retried at the same time.</p>

    <p>The retry implementation uses the library <a href="https://failsafe.dev/">failsafe</a></p>

    <h3>UserAgentMiddleware</h3>

    <p>The <a href="../../../../io/vrap/rmf/base/client/http/UserAgentMiddleware.html" title="class in io.vrap.rmf.base.client.http"><code>UserAgentMiddleware</code></a> adds an user agent header to every request. By default
    is submits the following data:</p>
    <ul>
        <li>SDK version</li>
        <li>JVM runtime version</li>
        <li>Operating system name and version</li>
    </ul>

    <div id="io-vrap-rmf-base-client-ClientBuilder-buildDefaultUserAgent--%s" class=code-example><pre><code class='java'>String runtimeVersion = SystemUtils.JAVA_RUNTIME_VERSION;
String osName = SystemUtils.OS_NAME;
String osArch = SystemUtils.OS_ARCH;
String sdkVersion = BuildInfo.VERSION;
return userAgent + sdkVersion + " " + " Java/" + runtimeVersion + " (" + osName + "; " + osArch + ")";
</code><p>See the <a href="https://github.com/commercetools/commercetools-sdk-java-v2/blob/master/rmf/rmf-java-base/src/main/java/io/vrap/rmf/base/client/ClientBuilder.java" target="_blank">test code</a>.</pre></div>

    <h3>AcceptGZipMiddleware</h3>

    <p>The <a href="../../../../io/vrap/rmf/base/client/http/AcceptGZipMiddleware.html" title="class in io.vrap.rmf.base.client.http"><code>AcceptGZipMiddleware</code></a> adds an <code>Accept-Encoding: gzip</code> header, to
    enable the ability of an compressed response as this reduces the data transport time.</p>

    <div id="io-vrap-rmf-base-client-http-AcceptGZipMiddleware-invoke-io-vrap-rmf-base-client-ApiHttpRequest--java-util-function-Function-%s" class=code-example><pre><code class='java'>return next.apply(request.withHeader(ApiHttpHeaders.ACCEPT_ENCODING, "gzip"));
</code><p>See the <a href="https://github.com/commercetools/commercetools-sdk-java-v2/blob/master/rmf/rmf-java-base/src/main/java/io/vrap/rmf/base/client/http/AcceptGZipMiddleware.java" target="_blank">test code</a>.</pre></div>

    <h3>InternalLoggerMiddleware</h3>

    <p>The <a href="../../../../io/vrap/rmf/base/client/http/InternalLoggerMiddleware.html" title="interface in io.vrap.rmf.base.client.http"><code>InternalLoggerMiddleware</code></a></p> logs every request send using the SDK. Depending
    on the configured logging level the default implementation logs the sent request and the returning response. The info level
    outputs the request method, url and the response status code. Using debug level the request and response instance will be logged.
    With trace level it will pretty print body of the request as well the response. To avoid leaking of sensitive data the
    logger redacts passwords, tokens and some other sensitive data.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor.summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><span class="member-name-link"><a href="#%3Cinit%3E()">Middlewares</a></span>()</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method.summary">
<h2>Method Summary</h2>
<div class="inherited-list">
<h3 id="methods.inherited.from.class.java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor.detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>Middlewares</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name"><a href="../../../../src-html/com/commercetools/docs/meta/Middlewares.html#line.73">Middlewares</a></span>()</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><span id="custom-javascripts"></span><script src="../../../../resources/javascripts/main.js"></script><link rel="stylesheet" href="../../../../resources/stylesheets/main.css"></small></p>
</footer>
</div>
</div>
</body>
</html>
